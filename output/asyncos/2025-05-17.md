# 2025-05-17 会议纪要

## 明杨

- 从 rcore 迁移过来的
- 中断发生的时候处理
- virtio-net mmio 注册 PLIC
- qemu 中跑的
- mmio_async
- 把 http server 改造成异步的
- 陈老师提供 arceos 版本
- 思考
  - 找名扬的仓库 
    - 上层还是有感知的
    - 调度器是哪部分来做的?

## 刘轶凡

- embassy | arielos - 查看他们的线程调度策略 - 引入 zcoro 中
- executor - 集中执行器 - yuanziwei 代码很像
  - executor-single-thread - 单线程执行器
  - exector-thread - 线程执行器
  - interupt-executor - 带抢占的执行器 - 抢占式执行器
- task 和 thread 协作抢占
- yuanziwei - 跑了一大堆 sleep - 与实际场景不太符合
- 从协程的粒度进行复用调度
  - 协程和线程的问题
  - 同步和异步分开混在一起
- 不认同他们的做法 - 不应该有同步和异步区分 - 40:57 - 这个观点重合了 - 太棒了
- 带优先级的协程调度 - 代码里 - async-os 还不理想
- 下周工作建议

## 陈毅俊

- 栈分配的问题 - 找他的文档 - 要找
  - 高优先级执行完才执行低优先级
  - 高优先级的抢占该怎么办？
  - 需要有换栈的情况 - 换成高优先级不一定有栈
  - 低优先级的 rr 问题
- RTIC 的实现 - 跟 ariel-os 差不多
  - 资源共享的方式
  - 不用很多的锁的方式
  - 写的很工整
  - ariel-os 可以用 yaml 统一配置
- 硬件抽象层各自自己封 - embbed-hal
  - axhal
  - 嵌入式和带 MMU 的分开
- 调度相关的处理 1:30:00 - 要找
  - 需要有抢占的协程
  - 需要有数据的支撑
  - 很多工作是无法进行量化
    - 硬件抽象层的问题 - 不具体 - 切碎小块定制
- 可配置化的硬件抽象层的概念 - 定制化硬件抽象层
- 思考
  - 线程和协程调度的是函数
    - 换函数栈 - 绿色线程 - coroutine
    - 换执行流 - 共享函数栈 - 相当于在一个线程上进行切换执行流 - future - thread per core
      - 协程执行流切换本来的特点就是 poll 一次，没有抢占机制
    - 多线程隔离调度 - 每个线程有一个自己的调度器
  - 如果在多个进程间进行协程的切换 - 这个时候
    - 多线程但是共享调度器 - 无法保持在同一个函数栈上是无法进程执行流的切换的
    - 多进程共享调度器 - 地址空间、栈都不同 - 更无法进行执行流的切换
    - 两种做法
      - 共享函数栈
      - 必要的时机进行函数栈切换

## 周积萍

- async-uring - 代码仓库 - 没有测试到他的场景
- 分享示例代码 - 没有完整的测试代码
- 在 WSL 响应特别慢
- 利用 tokio 进行测试
- 测试的运行时
  - tikio-uring 运行时的
    - 单线程执行器
    - 多线程需要每个都 spawn 运行时
    - SIGABRT 出现 bug
  - monoio - 字节写的
    - monoio 宏展开不是绑定到单个核
    - thread per core
- 图表 - st | mt 是代表什么意思 - 用的图标工具是什么工具 - rstudio ? 
- os-checker - benching-uring 测试仓库
- 老师提问
  - async-uring 代码看了吗
  - io-uring 不需要运行时
  - async-uring 底层搭配了多种 runtime 的实现 - 需要看底层实现 - 要找 - 1:17:00
  - 清华大学某个学生写的运行时
  - 我们在统一什么呢？
  - 再写一个运行时 - 优化的不好
  
## 杨金博

- 陈老师 - 发的文章 - flakeos - 要找